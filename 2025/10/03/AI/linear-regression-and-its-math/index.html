<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.clo5de.info","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.17.1","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":true,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":10,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Simply recording something about linear regression and its mathematics. &gt;&gt; [zhTW version] &lt;&lt;">
<meta property="og:type" content="article">
<meta property="og:title" content="Linear Regression &amp; its mathematics">
<meta property="og:url" content="https://www.clo5de.info/2025/10/03/AI/linear-regression-and-its-math/index.html">
<meta property="og:site_name" content="clooooode">
<meta property="og:description" content="Simply recording something about linear regression and its mathematics. &gt;&gt; [zhTW version] &lt;&lt;">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-10-03T21:21:56.000Z">
<meta property="article:modified_time" content="2025-10-18T08:35:04.453Z">
<meta property="article:author" content="clooooode">
<meta property="article:tag" content="AI">
<meta property="article:tag" content="Machine Learning">
<meta property="article:tag" content="Regression Analysis">
<meta property="article:tag" content="Linear Regression">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://www.clo5de.info/2025/10/03/AI/linear-regression-and-its-math/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://www.clo5de.info/2025/10/03/AI/linear-regression-and-its-math/","path":"2025/10/03/AI/linear-regression-and-its-math/","title":"Linear Regression & its mathematics"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Linear Regression & its mathematics | clooooode</title>
  







<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NGLBLXHD');</script>
<!-- End Google Tag Manager -->
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NGLBLXHD"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
    
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">clooooode</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">a.k.a. clo5de</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-github"><a href="https://github.com/jackey8616" rel="section" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a></li><li class="menu-item menu-item-e-mail"><a href="mailto:clode@clo5de.info" rel="section" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a></li><li class="menu-item menu-item-linkedin"><a href="https://www.linkedin.com/in/ko-li-mo-294832118/" rel="section" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#linear-regression"><span class="nav-number">1.</span> <span class="nav-text">Linear Regression</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#how-to-build-model"><span class="nav-number">2.</span> <span class="nav-text">How to build model</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#loss-function"><span class="nav-number">3.</span> <span class="nav-text">Loss Function</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#de-assemble-mse-by-chart"><span class="nav-number">3.1.</span> <span class="nav-text">De-assemble MSE by chart</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mae-vs-mse"><span class="nav-number">3.2.</span> <span class="nav-text">MAE vs MSE</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#optimizer"><span class="nav-number">4.</span> <span class="nav-text">Optimizer</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#gradient-descent"><span class="nav-number">4.1.</span> <span class="nav-text">Gradient Descent</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#slope-differentiation"><span class="nav-number">4.1.1.</span> <span class="nav-text">Slope &amp; Differentiation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#optimizing-iteration-rules"><span class="nav-number">4.1.2.</span> <span class="nav-text">Optimizing iteration rules</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#massive-calculate-bonus-dual-feature-gradient-descent"><span class="nav-number">4.2.</span> <span class="nav-text">!Massive
Calculate! Bonus: Dual-feature gradient descent</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#beside-gradient-descent"><span class="nav-number">4.3.</span> <span class="nav-text">Beside gradient descent?</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#so-mae-or-mse"><span class="nav-number">5.</span> <span class="nav-text">So MAE or MSE?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#last"><span class="nav-number">6.</span> <span class="nav-text">Last</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="clooooode"
      src="https://avatars1.githubusercontent.com/u/12930377?s=400&u=3e932a7f6b769a0e1028806815067be598db3351&v=4">
  <p class="site-author-name" itemprop="name">clooooode</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">47</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">55</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/jackey8616" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;jackey8616" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:clode@clo5de.info" title="E-Mail → mailto:clode@clo5de.info" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/ko-li-mo-294832118/" title="LinkedIn → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;ko-li-mo-294832118&#x2F;" rel="noopener me" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://www.clo5de.info/2025/10/03/AI/linear-regression-and-its-math/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars1.githubusercontent.com/u/12930377?s=400&u=3e932a7f6b769a0e1028806815067be598db3351&v=4">
      <meta itemprop="name" content="clooooode">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="clooooode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Linear Regression & its mathematics | clooooode">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Linear Regression & its mathematics
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-10-03 21:21:56" itemprop="dateCreated datePublished" datetime="2025-10-03T21:21:56+00:00">2025-10-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-10-18 08:35:04" itemprop="dateModified" datetime="2025-10-18T08:35:04+00:00">2025-10-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/AI/" itemprop="url" rel="index"><span itemprop="name">AI</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="firestore-visitors-count"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>2.4k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>9 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>Simply recording something about linear regression and its
mathematics.<br />
<a href="/2025/10/03/AI/linear-regression-and-its-math-zhTW/" title="Linear Regression &amp; its mathematics(zhTW)">&gt;&gt; [zhTW version] &lt;&lt;</a></p>
<span id="more"></span>
<h2 id="linear-regression">Linear Regression</h2>
<p>TL;DR: with a batch of data, find the trend, use the trend to
predict, this is linear regression analysis.</p>
<blockquote>
<p>For example: 10,000 pieces of data showing the relationship between
advertising budget and sales revenue.</p>
</blockquote>
<p>The essence of regression analysis is model building and inference(or
prediction).<br />
Take above example, the model can tell us what effect it has on revenue
for every dollar increase in advertising.<br />
I will use the simplest linear regression to explain.</p>
<blockquote>
<p>In order for the model to work properly, we will assume there is some
kind of linear relationship between advertising budget and
revenue.<br />
Which means, if you spend more money on advertising, revenue will
roughly increases.(Not exactly correct, but we assume this trend
works)<br />
Besides, we also assume each data point is independent(the sales revenue
would not be effected by previous weeks), and model’s prediction error
would not get bigger or smaller based on advertising budget.</p>
<p>These assumptions help us to use a simple way to learn how an
effective model works.<br />
Of course, reality work would not always follow these assumptions, but
we can understand the foundations of a model.</p>
</blockquote>
<h2 id="how-to-build-model">How to build model</h2>
<ol type="1">
<li><p>Mathematic assumption: the purpose of modeling is to find out a
formula as close as possible to the trend.<br />
Take single feature linear regression as example:<br />
<span class="math display">\[
h(x) = w x + b
\]</span> We can simplify with:<br />
<span class="math display">\[
\hat{y} = w x + b
\]</span> The <span class="math inline">\(x\)</span> is variable(like
advertising budge), <span class="math inline">\(\hat{y}\)</span> is
predicted value(how much revenue gain),<br />
And <span class="math inline">\(w_1\)</span>(weight) <span
class="math inline">\(b\)</span>(bias) is the parameters model needs to
learn and optimize.</p></li>
<li><p>Loss Function: measure the error during the training
process.<br />
Based on the error, we can tune the training direction(by changing
weight and bias).<br />
For example, inside the training data, <span class="math inline">\(x =
1, y = 9\)</span>，<br />
But the predict value from model is <span class="math inline">\(x = 1,
\hat{y} = 7\)</span>, the <span class="math inline">\(2\)</span> is the
error.</p>
<blockquote>
<p>Error = Actual Value - Predicted Value<br />
9 (Actual Value) - 7(Predicted Value) = Residual</p>
</blockquote>
<p>Error is acceptable, becuz there is no “perfect” model.<br />
But once an error becomes too big and is classified as an outlier, the
function of the Loss Function is precisely to aggregate and utilize. The
common way in Loss Function is MSE(Mean Square Error).</p></li>
<li><p>Optimizer: tune the parameter during the training process By
using loss function with proper optimizing strategy to achieve the goal
of changing parameter in next iteration.</p></li>
</ol>
<h2 id="loss-function">Loss Function</h2>
<p>MSE(Mean Square Error)：<br />
<span class="math inline">\(J_\mathbf{MSE} = \frac1{m}\sum_{i=1}^{m}
(y_{i} - \hat{y}_{i}) ^ 2\)</span></p>
<p>Q: Why MSE can be use as loss function?</p>
<blockquote>
<p>We hope we can find a formula, which can calculates the whole errors
during the whole dataset, and we do our best to let this formula as
close as possible to zero, which means the performance of model is
good.</p>
</blockquote>
<h3 id="de-assemble-mse-by-chart">De-assemble MSE by chart</h3>
<div id="mse" style="width: 100%; height: 500px;">

</div>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var myChart = echarts.init(document.getElementById('mse'));
    
    var rawData = [
      [2, 50], [4, 65], [6, 50], [8, 90], [10, 75], [12, 160]
    ];

    function predict(x) {
      return 5 * x + 35;
    }

    var residualData = rawData.map(function(item) {
      var x = item[0];
      var actualY = item[1];
      var predictedY = predict(x);
      
      return [x, actualY, predictedY];
    });
    
    var regressionLineData = [
      [2, predict(2)],
      [12, predict(12)]
    ];

    var option = {
      backgroundColor: '#fff',
      legend: {
        data: ['Original Data', 'Regression line', 'Error'],
        bottom: 0
      },
      xAxis: {
        type: 'value',
        name: 'Budget(10K)',
        min: 0,
        max: 14,
        nameLocation: 'middle'
      },
      yAxis: {
        type: 'value',
        name: 'Revenue(10K)',
        min: 30,
        max: 180,
        nameLocation: 'middle'
      },
      series: [
        {
          name: 'Original Data',
          type: 'scatter', 
          data: rawData,
          symbolSize: 15,
          itemStyle: { color: '#007bff' }
        },
        {
          name: 'Regression Line',
          type: 'line', 
          data: regressionLineData,
          symbol: 'none',
          lineStyle: {
            color: 'red',
            width: 3,
            type: 'solid'
          }
        },
        {
          name: 'Error',
          type: 'custom',
          data: residualData,
          renderItem: function (params, api) {
            var xValue = api.value(0);
            
            var pointActual = api.coord([xValue, api.value(1)]);
            var pointPredicted = api.coord([xValue, api.value(2)]);

            // 绘制线段 (残差)
            return {
              type: 'line', 
              shape: {
                x1: pointActual[0], 
                y1: pointActual[1], 
                x2: pointPredicted[0], 
                y2: pointPredicted[1] 
              },
              style: api.style({
                stroke: api.value(1) > api.value(2) ? 'green' : 'orange', 
                lineWidth: 2,
                lineDash: [4, 4] // 虚线
              })
            };
          }
        }
      ]
    };

    myChart.setOption(option);
  });
</script>
<p>As you can see from the chart, red line represents the regression
line in a training, blue dot is actual value( <span
class="math inline">\(x_i, y_i\)</span> ),x-axis as variable,each dot on
the red line is the predicted value( <span
class="math inline">\(\hat{y}\)</span> ) in the given variable
x.。<br />
There is some positive error and negative error, the purpose of training
is to reduce these error as many as possible.<br />
In the chart, <span class="math inline">\(\hat{y}_6\)</span> (predicted
value)has a huge difference with actual value, we call it outlier, this
outlier may cause impact to the training result.</p>
<p>Below it the error base on the chart: <span class="math display">\[
\begin{align*}
E_i &amp;= y_i - \hat{y}_{i} \\
E_1 &amp;= 50 - 45 = 5 \\
E_2 &amp;= 65 - 55 = 10 \\
E_3 &amp;= 50 - 65 = -15 \\
E_4 &amp;= 90 - 75 = 25 \\
E_5 &amp;= 75 - 85 = -10 \\
E_6 &amp;= 160 - 95 = 65
\end{align*}
\]</span> If we are going to calculates the average error, normally way
to do it is find average value with summation of errors(Arithmetic
Mean):<br />
<span class="math display">\[
\frac{1}{m}\sum_{m=1}^{m} E_{i}
\]</span> This bring a problem:<br />
Positive and negative error will cancel each other out(or offset), thus
we need to find another way to avoid the cancellation.</p>
<h3 id="mae-vs-mse">MAE vs MSE</h3>
<p>In match, common way to remove negative value is by take absolute or
square. <span class="math display">\[
\begin{align*}
Mean Absolute Error, MAE &amp;= \frac{1}{m}\sum_{m=1}^{m}
\big|E_{i}\big| \\
Mean Square Error, MSE &amp;= \frac{1}{m}\sum_{m=1}^{m} {E_{i}}^2
\end{align*}
\]</span> Two ways, which one should we use?<br />
We keep this problem for now, I will answer later.<br />
In the applied math in machine learning, there is no single correct
answer; it’s more about trade-offs.</p>
<h2 id="optimizer">Optimizer</h2>
<p>The purpose of optimizing is to gradually change the value of <span
class="math inline">\(w\)</span> in order to reduce the error from loss
function, it would be ideal to get zero from loss function.<br />
In machine learning fields, optimizer usually represents gradient-based
optimizers,<br />
there is more other optimizing strategy, but we won’t discuss in this
article.</p>
<h3 id="gradient-descent">Gradient Descent</h3>
<p>The essence of a gradient is the derivative, it points to the fastest
growth direction at current position(steepest uphill),<br />
In order to make it easier to understand the mathematic theory, I will
simplify the predict function <span
class="math inline">\(\hat{y}_i\)</span> into a single-feature
function.</p>
<blockquote>
<p>Here we let <span class="math inline">\(b = 0\)</span> is just only
to help us to discuss the theory, in practice, you won’t even see this
kind of ideal situation. If <span class="math inline">\(b != 0\)</span>
will let the gradient descent function become a dual-feature, that would
make this section much more complicated, so I will skip this part
here.</p>
</blockquote>
<p><span class="math display">\[
\begin{align*}
\because Let\space b &amp;= 0 \\
\therefore \hat{y}_i &amp;= wx + 0 \\
&amp;= wx
\end{align*}
\]</span> We just need to involve with feature <span
class="math inline">\(w\)</span> .</p>
<div id="jw_curve" style="width: 100%; height: 500px;">

</div>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var myChart = echarts.init(document.getElementById('jw_curve'));

    var rawData = [
      [2, 50], [4, 65], [6, 50], [8, 90], [10, 75], [12, 160]
    ];

    function mse(w) {
      let sum = 0;
      for(let i = 0; i < rawData.length; i++) {
        sum += (rawData[i][1] - w * rawData[i][0]) ** 2;
      }
      return sum / rawData.length;
    }

    function errorData() {
      let data = [];
      for (let i = -10; i <= 30; i += 0.1) {
        data.push([i, mse(i)]);
      }
      return data;
    }

    var option = {
      backgroundColor: '#fff',
      xAxis: {
        type: 'value',
        name: 'Weight'
      },
      yAxis: {
        type: 'value',
        name: 'J(w)'
      },
      tooltip: {
        trigger: 'axis',
      },
      series: [
        {
          name: 'Error',
          type: 'line',
          data: errorData(),
          showSymbol: false,
          clip: true,
          itemStyle: { color: '#007bff' }
        }
      ],
    };

    myChart.setOption(option);
  });
</script>
<p>As the chart, this is the relationship between <span
class="math inline">\(w\)</span> weight and <span
class="math inline">\(J(w)\)</span> errors.<br />
I meant to take out all the possibilities of <span
class="math inline">\(w\)</span> to draw the chart, in actual training
cases, its more like the system trying-error with each point’s( <span
class="math inline">\(w\)</span> ) value blindly.</p>
<p>As you can see from the chart, when <span class="math inline">\(w =
[11.1, 11.2]\)</span> is inside of this interval, we can find the
smallest value of <span class="math inline">\(J(w)\)</span> .<br />
In mathematics, the way we finding a minimum value of a function is
relative with slope.</p>
<h4 id="slope-differentiation">Slope &amp; Differentiation</h4>
<p>By calculate the y-axis’s offset with two dots on a curve, we can get
the slope(trend) of these two points.<br />
Take <span class="math inline">\(w_{best}\)</span> as example, the point
that <span class="math inline">\(J(w)\)</span> is closest to zero(or the
minimum of the whole curve) of <span class="math inline">\(w\)</span> is
<span class="math inline">\(w_{best}\)</span>: <span
class="math display">\[
\begin{align*}
J(11.1) &amp;= 581.4066 \\
J(11.2) &amp;= 581.693 \\
m &amp;= (581.693 - 581.4066) / (11.2 - 11.1) \\
&amp;= 0.2864 / 0.1 \\
&amp;= 0.02864
\end{align*}
\]</span></p>
<p>With this slope as tool, it allows us to find out we should
increase/decrease the value of <span class="math inline">\(w\)</span> in
order to get minimum <span class="math inline">\(J(w)\)</span> .<br />
No matter the slope is positive or negative, it always means we need to
correct the value in the opposite direction the value of <span
class="math inline">\(w\)</span> in order to get a slope closes zero as
many as possible.</p>
<p>In math, to find a slope of any point on a smooth curve, we use
differentiation.<br />
<span class="math display">\[
\begin{align*}
Let\space u &amp;= (y_i - wx_i), f(u) = u ^ 2 \\
J(w) &amp;= \frac{1}{m}\sum_{i=1}^{m}f(u) \\
\dfrac{dJ}{dw} &amp;= \frac{1}{m}\sum_{i=1}^{m}\dfrac{df}{dw} \\
\because \dfrac{df}{dw} &amp;= \dfrac{df}{du} \times \dfrac{du}{dw} \\
&amp;= 2u \times \dfrac{d}{dw}(y_i - wx_i) \\
&amp;= 2u \times (0 - x_i) \\
&amp;= 2(y_i - wx_i) \times -x_i \\
\therefore \dfrac{dJ}{dw} &amp;= \frac{1}{m}\sum_{i=1}^{m}2(y_i -
wx_i)(-x_i) \\
&amp;= \frac{2}{m}\sum_{i=1}^{m}(- y_i + wx_i)(x_i) \\
&amp;= \frac{2}{m}\sum_{i=1}^{m}(wx_i - y_i)(x_i) \\
\because \hat{y}_i &amp;= wx_i \\
\therefore \dfrac{dJ}{dw} &amp;= \frac{2}{m}\sum_{i=1}^{m}(\hat{y}_i -
y_i)x_i \\
\end{align*}
\]</span> Thus, we found the gradient function which can help us make
correction on parameter <span class="math inline">\(w\)</span> created
by out loss function.</p>
<h4 id="optimizing-iteration-rules">Optimizing iteration rules</h4>
<p>By using gradient formula:<span class="math inline">\(\dfrac{dJ}{dw}
= \frac{2}{m}\sum_{i=1}^{m}(\hat{y}_i - y_i)x_i\)</span><br />
We can get a optimizer’s iteration rules:<span
class="math inline">\(w_{new} = w_{old} - \alpha \cdot
\dfrac{dJ}{dw}\)</span></p>
<p>Here, <span class="math inline">\(\alpha\)</span> is a learning rate,
works like an amplifying parameter, which controls learning speed and
the stability of convergence.</p>
<ul>
<li><span class="math inline">\(\alpha\)</span> too big:
Over-shooting:<br />
It causes training to jump back and forth near the bottom of the curve,
eventually cannot converge<br />
</li>
<li><span class="math inline">\(\alpha\)</span> too small: Slow
Convergence:<br />
The optimizer will learn in a very slow speed to find the best <span
class="math inline">\(w\)</span> ,but it will be time-consuming.</li>
</ul>
<p>In actual training <span class="math inline">\(\alpha\)</span> is
called a hyperparameter, it should be setup and manually tuning before
training.<br />
We won’t talk about <span class="math inline">\(\alpha\)</span> here,
becuz is comes with much more deep dive, we will skip this part
here.</p>
<p>With optimizer in countless training(we called it epochs), <span
class="math inline">\(w\)</span> will move toward the fastest decent
direction with curve.<br />
Eventually will let <span class="math inline">\(J(w)\)</span> became
stable, we call it convergence, at this point, the <span
class="math inline">\(w\)</span> is <span
class="math inline">\(w_{best}\)</span>.<br />
Then:</p>
<p><span class="math display">\[
\hat{y} = w_{best}x
\]</span></p>
<h3 id="massive-calculate-bonus-dual-feature-gradient-descent">!Massive
Calculate! Bonus: Dual-feature gradient descent</h3>
<p>Above we let <span class="math inline">\(b = 0\)</span> in order to
make <span class="math inline">\(\hat{y}\)</span> become single feature,
which helps us easier to working on the math.<br />
Now we put back <span class="math inline">\(b\)</span> : <span
class="math inline">\(\hat{y} = wx + b\)</span><br />
Then we need to do the partial derivative to <span
class="math inline">\(w\)</span> and <span
class="math inline">\(b\)</span> :<br />
<span class="math display">\[
\begin{align*}
Define：\\
\hat{y} &amp;= wx + b \\
J(w,b) &amp;= \frac{1}{m}\sum_{i=1}^{m}(y_i - \hat{y}_i) ^ 2 \\
&amp;= \frac{1}{m}\sum_{i=1}^{m}(y_i - (wx_i + b)) ^ 2 \\
Let:\\
u &amp;= (y_i - \hat{y}_i) \\
f(u) &amp;= u ^ 2 \\
\end{align*}
\]</span> Then for <span
class="math inline">\(\dfrac{dJ}{dw}\)</span>:<br />
<span class="math display">\[
\begin{align*}
\dfrac{dJ}{dw} &amp;= \frac{1}{m}\sum_{i=1}^{m}\dfrac{df}{dw} \\
\because \dfrac{df}{dw} &amp;= \dfrac{df}{du} \times \dfrac{du}{dw} \\
&amp;= 2u \times \dfrac{d}{dw}(y_i - (wx_i + b)) \\
&amp;= 2u \times (0 - x_i - 0) \\
&amp;= 2u \times - x_i \\
\therefore \dfrac{dJ}{dw} &amp;= \frac{1}{m}\sum_{i=1}^{m} (2u \times -
x_i) \\
&amp;= \frac{1}{m}\sum_{i=1}^{m}(2(y_i - \hat{y}_i) \times - x_i) \\
&amp;= \frac{2}{m}\sum_{i=1}^{m}(\hat{y}_i - y_i)x_i \\
\end{align*}
\]</span> for <span class="math inline">\(\dfrac{dJ}{db}\)</span>:<br />
<span class="math display">\[
\begin{align*}
\dfrac{dJ}{db} &amp;= \frac{1}{m}\sum_{i=1}^{m}\dfrac{df}{db} \\
\because \dfrac{df}{db} &amp;= \dfrac{df}{du} \times \dfrac{du}{db} \\
&amp;= 2u \times \dfrac{d}{db}(y_i - (wx_i + b)) \\
&amp;= 2u \times (0 - 0 - 1) \\
&amp;= 2u \times -1 \\
\therefore \dfrac{dJ}{db} &amp;= \frac{1}{m}\sum_{i=1}^{m}(-2u) \\
&amp;= \frac{1}{m}\sum_{i=1}^{m}(-2(y_i - \hat{y}_i)) \\
&amp;= \frac{2}{m}\sum_{i=1}^{m}(\hat{y}_i - y_i) \\
\end{align*}
\]</span> Eventually:<br />
<span class="math display">\[
\begin{align*}
w_{new} &amp;= w_{old} - \alpha \cdot \dfrac{dJ}{dw} \\
&amp;= w_{old} - \alpha \cdot \frac{2}{m}\sum_{i=1}^{m}(\hat{y}_i -
y_i)x_i \\
b_{new} &amp;= b_{old} - \alpha \cdot \dfrac{dJ}{db} \\
&amp;= b_{old} - \alpha \cdot \frac{2}{m}\sum_{i=1}^{m}(\hat{y}_i - y_i)
\\
\end{align*}
\]</span> In the end we can find a simple conclusion:</p>
<blockquote>
<p>The correction of <span class="math inline">\(w\)</span> is affected
by <span class="math inline">\(x_i\)</span>; the input of the training
data determines the direction of correction.<br />
and the correction of <span class="math inline">\(b\)</span> is only
affected by the mean of total errors, <span
class="math inline">\(b\)</span> only simply moves the whole regression
function vertically.</p>
</blockquote>
<h3 id="beside-gradient-descent">Beside gradient descent?</h3>
<p>In math there is still another way called normal equation can
calculate the answer of <span class="math inline">\(w_{best}\)</span>
directly,<br />
like OLS(Ordinary least squares), but in machine learning field, its
almost not possible with such ideal environment,<br />
Thus in this article, we did not mention such solutions above.</p>
<h2 id="so-mae-or-mse">So MAE or MSE?</h2>
<p>MAE and MSE are all about collection errors, there is no plain answer
to use which of them.<br />
But more about the characteristic of training data and how you want the
model performs.</p>
<p>MAE itself, affected by the absolute, the curve would be non-smooth
but continuous,<br />
Which is not able to directly find the derivative of whole curve and
apply to optimizer’s iteration rules.<br />
It has to use some technique like sub-gradient to deal with the
non-differentiable point.<br />
In practice there is something more to do with optimizer, we will skip
this part here.</p>
<h2 id="last">Last</h2>
<p>This article discusses the simplest linear regression with MSE in
machine learning field and its mathematic theory.<br />
The field of machine learning is vast. I wrote this article as a way to
prepare for the AWS AI Practitioner(AIF-C01) and to figure out some
parts I didn’t fully understand before. It also helped me to brush up on
my Calculus(or rescue my falling Calculus knowledge)…</p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/AI/" rel="tag"># AI</a>
              <a href="/tags/Machine-Learning/" rel="tag"># Machine Learning</a>
              <a href="/tags/Regression-Analysis/" rel="tag"># Regression Analysis</a>
              <a href="/tags/Linear-Regression/" rel="tag"># Linear Regression</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/04/30/note/MatMul_zhTW/" rel="prev" title="MatMul: Matrix Multiplication">
                  <i class="fa fa-chevron-left"></i> MatMul: Matrix Multiplication
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/10/07/AI/logistic-regression-and-its-math/" rel="next" title="Logistic Regression & its mathematics">
                  Logistic Regression & its mathematics <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments utterances-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2018 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">clooooode</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">28k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">1:41</span>
  </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  

  <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-app-compat.js" integrity="sha256-FYa4Xn7MJlI18eIkwawbRKLz7bGeUODtNpSR+bsjlHg=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-firestore-compat.js" integrity="sha256-sgbLcRGF3ph6N+ymg9zoy9kFQDWBvJlCd0GbGMKBH0c=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="firestore" type="application/json">{"enable":true,"collection":"articles","apiKey":"AIzaSyCu9-MhzikdJ0BVgPRODV__hMffyr5bgZg","projectId":"clo5de-githubpage"}</script>
  <script src="/js/third-party/statistics/firestore.js"></script>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"jackey8616/jackey8616.github.io","issue_term":"title","theme":"github-dark","label":"ChatRoom"}</script>
<script src="/js/third-party/comments/utterances.js"></script>
<script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
</body>
</html>
